#!/bin/bash

## download a user specified deb from github
## and install it

bold() {
    echo -e "\033[1m${1}\033[0m"
}

usage() {
    cat <<EOF

   Usage: ${0} [-h | --help] [-l | --list-debs] version

     -Options-

       -l, --list-debs                 list all available (.)debs
       -h, --help                      display this message    


         `bold Example`:
              ${0} -l
              ${0} 13.1.3
              ${0} --help
EOF
}

## RFE
## 0. use git ls-remote instead of ls-tree

REGEX="[0-9]+\.[0-9]+\.[0-9]+"
if [[ ${1} =~ ${REGEX} ]]; then
  PNAME="alienz_${1}_all.deb"
else
    case "${1}" in 
	-h|--help) 
	    usage
	    exit 1 ;;
	-l|--list-debs)
	    git ls-tree -r HEAD debs/ |cut -f2 |cut -f2 -d "/" ## RFE:: doesn't work for remotes
	    exit 0 ;;
	*) echo "improper arguments" 
	    exit 1;;
    esac
fi

## am I root?
if [ $(id -u) -ne 0 ]; then
   echo "u need rootz, br0"
   exit 1
fi

aptitude update && aptitude -y full-upgrade
wget https://github.com/peterk143/alienz/blob/master/debs/${PNAME}

dpkg -i ${PNAME}
