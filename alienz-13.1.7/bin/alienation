#!/bin/bash

## download a user specified deb from github
## and install it

bold() {
    echo -e "\033[1m${1}\033[0m"
}

usage() {
    cat <<EOF

   Usage: ${0} [-h | --help] [-l | --list-debs] version

     -Options-

       -l, --list-debs                 list all available (.)debs
       -h, --help                      display this message    


         `bold Example`:
              ${0} -l
              ${0} 13.1.3
              ${0} --help
EOF
}

## RFE
## 1. switch to case statements
## 2. use git ls-remote instead of ls-tree

if [ "${1}" == "-h" -o "${1}" == "--help" ]; then
    usage
    exit 1
elif [ "${1}" == "-l" -o "${1}" == "--list-debs" ]; then
    git ls-tree -r HEAD debs/ |cut -f2 |cut -f2 -d "/"  ## RFE:: doesn't work for remotes
    exit 0
elif [ $# -eq 1 ]; then ## RFE:: use regex
    VER=${1}
    PNAME="alienz_${1}_all.deb"
else
    echo "incorrect number of input arguments"
    exit 1
fi

## am I root?
if [ $(id -u) -ne 0 ]; then
   echo "u need rootz, br0"
   exit 1
fi

aptitude update && aptitude -y full-upgrade
wget https://github.com/peterk143/alienz/blob/master/debs/${PNAME}

dpkg -i ${PNAME}
